cmake_minimum_required(VERSION 2.7)
set(CMAKE_VERBOSE_MAKEFILE ON)
project(sdrberry)
include(FetchContent)
set(LV_CONF_PATH ${CMAKE_CURRENT_SOURCE_DIR}/lv_conf.h CACHE STRING "" FORCE)
FetchContent_Declare(lvgl GIT_REPOSITORY  https://github.com/lvgl/lvgl.git
GIT_TAG v8.3.3)
FetchContent_MakeAvailable(lvgl)
#file(GLOB_RECURSE SOURCES ./lvgl/src/*.c)
set(LIBRARIES_FROM_REFERENCES -lbfd -ldl -lpthread -lbluetooth -lSoapySDR -latomic -ltinyb -lliquid -lasound -lfftw3 -Wl,-gc-sections)
include_directories(lvgl ft8)
add_executable(sdrberry sdrberry.cpp EnergyCalculator.cpp EnergyCalculator.h Limiter.cpp Limiter.h RtAudio.cpp backward.hpp FT8Demodulator.cpp FT8Demodulator.h SpectralNoiseReduction.cpp SpectralNoiseReduction.h LMSNoisereducer.cpp LMSNoisereducer.h HidDev.cpp HidDev.h PeakLevelDetector.cpp PeakLevelDetector.h ft8/fft.cpp ft8/fft.h ft8/ft8.cpp ft8/ft8.h ft8/libldpc.cpp ft8/unpack.cpp ft8/util.cpp ft8/osd.cpp ft8/arrays.h gui_ft8.cpp gui_ft8.h gui_rx.h gui_rx.cpp gui_speech.cpp gui_speech.h FMDemodulator.cpp Agc_class.cpp AMDemodulator.cpp AMModulator.cpp AudioInput.cpp AudioOutput.cpp BandFilter.cpp ble_interface.cpp Catinterface.cpp configfile.cpp configoption.cpp Demodulator.cpp Filter.cpp FmDecode.cpp FMDemodulator.cpp FMModulator.cpp FreeSansOblique24.c FreeSansOblique32.c FreeSansOblique42.c FT891_CAT.cpp gui_agc.cpp Gui_band.cpp gui_bar.cpp gui_setup.cpp gui_top_bar.cpp gui_tx.cpp gui_vfo.cpp Keyboard.cpp MidiControle.cpp Mouse.cpp PCF8574.cpp RtMidi.cpp SdrDevice.cpp sdrstream.cpp Settings.cpp vfo.cpp Waterfall.cpp wiringPiI2C.c wiringSerial.c lv_drivers/display/fbdev.c lv_drivers/indev/evdev.c lv_drivers/indev/mouse.c Agc_class.h AMDemodulator.h AMModulator.h AudioInput.h AudioOutput.h BandFilter.h ble_interface.h Catinterface.h configfile.h configoption.h DataBuffer.h Demodulator.h Filter.h FmDecode.h FMDemodulator.h FMModulator.h FT891_CAT.h gattlib.h gui_agc.h Gui_band.h gui_bar.h gui_setup.h gui_top_bar.h gui_tx.h gui_vfo.h Keyboard.h liquid.h liquid.internal.h lv_conf.h lv_drv_conf.h MidiControle.h Mouse.h PCF8574.h RtAudio.h RtMidi.h sdrberry.h SdrDevice.h sdrstream.h sma.h Settings.h vfo.h Waterfall.h wiringPiI2C.h wiringSerial.h strlib.cpp strlib.h MorseDecoder.cpp MorseDecoder.h EchoAudio.cpp EchoAudio.h FreeSans42.c ${SOURCES} lv_drivers/indev/evdev.h)
set_property(TARGET sdrberry PROPERTY CXX_STANDARD 17)
target_compile_definitions(sdrberry PRIVATE RELEASE=1 __LINUX_ALSA__ LV_LVGL_H_INCLUDE_SIMPLE)
target_compile_options(sdrberry PRIVATE -O3 -ggdb -Wno-deprecated -Wno-deprecated-declarations -I "." -I"/usr/include/arm-linux-gnueabihf/c++/10" -I"/usr/include/c++/10")
target_compile_options(sdrberry PRIVATE )
target_include_directories(sdrberry PRIVATE /usr/local/include/liquid)
target_link_libraries(sdrberry PRIVATE "${LIBRARIES_FROM_REFERENCES}")
target_link_libraries(sdrberry PRIVATE lvgl::lvgl)
install(TARGETS sdrberry DESTINATION /usr/local/bin)
