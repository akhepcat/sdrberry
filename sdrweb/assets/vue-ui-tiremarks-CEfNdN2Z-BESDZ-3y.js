import{c as Y}from"./useNestedProp-BxrcwmTZ-CudEJDco.js";import{z as se,c,r as d,D as ue,H as ne,w as J,B as ie,C as ve,a0 as ce,b as he,a1 as R,o as s,a as i,i as z,L as m,j as ge,l as F,m as b,p as j,q as B,u as g,M as K,n as G,J as ye,f as de,P as Q,k as W,h as me,U as pe,G as fe}from"./index-UNQvOp-_.js";import{x as ke}from"./Title-DyD-mBPN-D1JKsC4v.js";import{r as be,a as $e}from"./usePrinter-CLcxWv-4-BCaxEi1-.js";import we from"./vue-ui-skeleton-Dgzcn3FL-BesRK3Fh.js";import{p as xe}from"./PackageVersion-mSsg8dpu-BpMA5JNq.js";import{S as Ce}from"./PenAndPaper-Dk41ZrJ0-C6X1XG5F.js";import{s as Pe}from"./vue-data-ui-DF7u-eZV-Cm3hFNaA.js";const Ae=["id"],Ie={key:2,style:"width:100%;background:transparent;padding-bottom:12px"},ze=["xmlns","viewBox"],Fe={key:0},Oe=["d","stroke-width","stroke"],_e={key:1},Se=["x1","y1","x2","y2","stroke-width","stroke"],Me=["x","y","font-size","fill","font-weight","text-anchor"],je={key:5,class:"vue-data-ui-watermark"},Be={key:6,ref:"source",dir:"auto"},Ge={__name:"vue-ui-tiremarks",props:{config:{type:Object,default(){return{}}},dataset:{type:Object,default(){return{}}}},setup(Z,{expose:ee}){const h=Z,{vue_ui_tiremarks:te}=se(),O=c(()=>!!h.dataset&&Object.keys(h.dataset).length),_=d(ue()),S=d(null),ae=d(null),T=d(0),H=d(0),e=c({get:()=>N(),set:t=>t});function N(){const t=Y({userConfig:h.config,defaultConfig:te});return t.theme?{...Y({userConfig:ne.vue_ui_tiremarks[t.theme]||h.config,defaultConfig:t})}:t}J(()=>h.config,t=>{e.value=N(),U(),H.value+=1},{deep:!0});const{isPrinting:q,isImaging:D,generatePdf:E,generateImage:X}=be({elementId:_.value,fileName:e.value.style.chart.title.text||"vue-ui-tiremarks"}),le=c(()=>e.value.userOptions.show&&!e.value.style.chart.title.text),u=d(e.value.style.chart.animation.use?0:ce(h.dataset.percentage));J(()=>h.dataset,t=>{e.value.style.chart.animation.use?L(t.percentage):u.value=t.percentage||0},{deep:!0}),he(()=>{U()});function L(t){let a=e.value.style.chart.animation.speed;const l=Math.abs(t-u.value)/(a*120);function o(){u.value<t?u.value=Math.min(u.value+l,t):u.value>t&&(u.value=Math.max(u.value-l,t)),u.value!==t&&requestAnimationFrame(o)}o()}function U(){ie(h.dataset)&&ve({componentName:"VueUiTiremarks",type:"dataset"}),L(h.dataset.percentage||0)}const $=c(()=>e.value.style.chart.layout.display==="vertical"),n=c(()=>{const t={top:48,left:64,right:64,bottom:48};return $.value?{top:e.value.style.chart.percentage.verticalPosition==="top"?t.top:3,left:3,right:3,bottom:e.value.style.chart.percentage.verticalPosition==="bottom"?t.bottom:3}:{top:0,bottom:0,left:e.value.style.chart.percentage.horizontalPosition==="left"?t.left:3,right:e.value.style.chart.percentage.horizontalPosition==="right"?t.right:10}}),P=c(()=>Object.values(n.value).reduce((t,a)=>t+a,0)),r=c(()=>({height:$.value?312:56,width:$.value?56:312})),oe=d(100);c(()=>h.dataset.percentage/oe.value);const v=c(()=>$.value?{mark:(r.value.height-P.value)/100*.5,space:(r.value.height-P.value)/100*.5}:{mark:(r.value.width-P.value)/100*.5,space:(r.value.width-P.value)/100*.5}),V=c(()=>{const t=[];for(let a=0;a<100;a+=1){const l=e.value.style.chart.layout.ticks.gradient.show?R(e.value.style.chart.layout.activeColor,a/100*(e.value.style.chart.layout.ticks.gradient.shiftHueIntensity/100)):e.value.style.chart.layout.activeColor;if($.value){const o=e.value.style.chart.layout.crescendo?(100-a)*(r.value.width-n.value.left-n.value.right)/100/3:0,y=n.value.left+4+o,p=r.value.width-n.value.right-4-o,f=r.value.height-n.value.bottom-a*v.value.mark-a*v.value.space-v.value.mark,k=r.value.height-n.value.bottom-a*v.value.mark-a*v.value.space-v.value.mark,x=(p-y)/e.value.style.chart.layout.curveAngleX,C=e.value.style.chart.layout.curveAngleY*((1+a)/100);t.push({x1:y,x2:p,y1:f,y2:k,curve:`M ${y} ${f} C ${y+x} ${f-C}, ${p-x} ${k-C}, ${p} ${k}`,color:l})}else{const o=e.value.style.chart.layout.crescendo?(100-a)*(r.value.height-n.value.top-n.value.bottom)/100/3:0,y=n.value.left+a*v.value.mark+a*v.value.space-v.value.mark,p=y,f=n.value.top+4+o,k=r.value.height-n.value.bottom-4-o,x=e.value.style.chart.layout.curveAngleY*((1+a)/100),C=(k-f)/e.value.style.chart.layout.curveAngleX;t.push({x1:y,x2:p,y1:f,y2:k,curve:`M ${y} ${f} C ${y+x} ${f+C}, ${p+x} ${k-C}, ${p} ${k}`,color:l})}}return t}),w=c(()=>{let t,a,l;const o=e.value.style.chart.percentage.fontSize/3;return $.value?e.value.style.chart.percentage.verticalPosition==="top"?(t=r.value.width/2,a=n.value.top/2,l="middle"):e.value.style.chart.percentage.verticalPosition==="bottom"&&(t=r.value.width/2,a=r.value.height-n.value.bottom/2+o,l="middle"):e.value.style.chart.percentage.horizontalPosition==="left"?(t=4,a=r.value.height/2+o,l="start"):e.value.style.chart.percentage.horizontalPosition==="right"&&(t=r.value.width-n.value.right+8,a=r.value.height/2+o,l="start"),{x:t,y:a,textAnchor:l,bold:e.value.style.chart.percentage.bold,fontSize:e.value.style.chart.percentage.fontSize,fill:e.value.style.chart.percentage.color}}),A=d(!1);function re(t){A.value=t,T.value+=1}const I=d(!1);function M(){I.value=!I.value}return ee({generatePdf:E,generateImage:X,toggleAnnotator:M}),(t,a)=>(s(),i("div",{ref_key:"tiremarksChart",ref:S,class:G(`vue-ui-tiremarks ${e.value.useCssAnimation?"":"vue-ui-dna"}`),style:K(`font-family:${e.value.style.fontFamily};width:100%; text-align:center;background:${e.value.style.chart.backgroundColor}`),id:_.value},[e.value.userOptions.buttons.annotator?(s(),z(Ce,{key:0,parent:S.value,backgroundColor:e.value.style.chart.backgroundColor,color:e.value.style.chart.color,active:I.value,onClose:M},null,8,["parent","backgroundColor","color","active"])):m("",!0),le.value?(s(),i("div",{key:1,ref_key:"noTitle",ref:ae,class:"vue-data-ui-no-title-space",style:"height:36px; width: 100%;background:transparent"},null,512)):m("",!0),e.value.style.chart.title.text?(s(),i("div",Ie,[(s(),z(ke,{key:`title_${H.value}`,config:{title:{cy:"wheel-title",...e.value.style.chart.title},subtitle:{cy:"wheel-subtitle",...e.value.style.chart.title.subtitle}}},null,8,["config"]))])):m("",!0),e.value.userOptions.show&&O.value?(s(),z($e,{ref:"details",key:`user_options_${T.value}`,backgroundColor:e.value.style.chart.backgroundColor,color:e.value.style.chart.color,isPrinting:g(q),isImaging:g(D),uid:_.value,hasPdf:e.value.userOptions.buttons.pdf,hasImg:e.value.userOptions.buttons.img,hasFullscreen:e.value.userOptions.buttons.fullscreen,hasXls:!1,isFullscreen:A.value,titles:{...e.value.userOptions.buttonTitles},chartElement:S.value,position:e.value.userOptions.position,hasAnnotator:e.value.userOptions.buttons.annotator,isAnnotation:I.value,onToggleFullscreen:re,onGeneratePdf:g(E),onGenerateImage:g(X),onToggleAnnotator:M},ge({_:2},[t.$slots.optionPdf?{name:"optionPdf",fn:F(()=>[b(t.$slots,"optionPdf",{},void 0,!0)]),key:"0"}:void 0,t.$slots.optionImg?{name:"optionImg",fn:F(()=>[b(t.$slots,"optionImg",{},void 0,!0)]),key:"1"}:void 0,t.$slots.optionFullscreen?{name:"optionFullscreen",fn:F(({toggleFullscreen:l,isFullscreen:o})=>[b(t.$slots,"optionFullscreen",j(B({toggleFullscreen:l,isFullscreen:o})),void 0,!0)]),key:"2"}:void 0,t.$slots.optionAnnotator?{name:"optionAnnotator",fn:F(({toggleAnnotator:l,isAnnotator:o})=>[b(t.$slots,"optionAnnotator",j(B({toggleAnnotator:l,isAnnotator:o})),void 0,!0)]),key:"3"}:void 0]),1032,["backgroundColor","color","isPrinting","isImaging","uid","hasPdf","hasImg","hasFullscreen","isFullscreen","titles","chartElement","position","hasAnnotator","isAnnotation","onGeneratePdf","onGenerateImage"])):m("",!0),O.value?(s(),i("svg",{key:4,xmlns:g(ye),class:G({"vue-data-ui-fullscreen--on":A.value,"vue-data-ui-fulscreen--off":!A.value}),viewBox:`0 0 ${r.value.width} ${r.value.height}`,style:K(`max-width:100%; overflow: visible; background:transparent;color:${e.value.style.chart.color}`)},[de(xe),e.value.style.chart.layout.curved?(s(),i("g",Fe,[(s(!0),i(Q,null,W(V.value,(l,o)=>(s(),i("path",{d:l.curve,"stroke-width":v.value.mark,stroke:u.value>=o?l.color:e.value.style.chart.layout.inactiveColor,"stroke-linecap":"round",fill:"none",class:G({"vue-ui-tick-animated":e.value.style.chart.animation.use&&o<=u.value})},null,10,Oe))),256))])):(s(),i("g",_e,[(s(!0),i(Q,null,W(V.value,(l,o)=>(s(),i("line",{x1:l.x1,y1:l.y1,x2:l.x2,y2:l.y2,"stroke-width":v.value.mark,stroke:u.value>=o?l.color:e.value.style.chart.layout.inactiveColor,"stroke-linecap":"round"},null,8,Se))),256))])),e.value.style.chart.percentage.show?(s(),i("text",{key:2,x:w.value.x,y:w.value.y,"font-size":w.value.fontSize,fill:e.value.style.chart.layout.ticks.gradient.show&&e.value.style.chart.percentage.useGradientColor?g(R)(e.value.style.chart.layout.activeColor,u.value/100*(e.value.style.chart.layout.ticks.gradient.shiftHueIntensity/100)):e.value.style.chart.percentage.color,"font-weight":w.value.bold?"bold":"normal","text-anchor":w.value.textAnchor},me(g(pe)(e.value.style.chart.percentage.formatter,u.value,g(fe)({v:u.value,s:"%",r:e.value.style.chart.percentage.rounding}))),9,Me)):m("",!0),b(t.$slots,"svg",{svg:r.value},void 0,!0)],14,ze)):m("",!0),t.$slots.watermark?(s(),i("div",je,[b(t.$slots,"watermark",j(B({isPrinting:g(q)||g(D)})),void 0,!0)])):m("",!0),t.$slots.source?(s(),i("div",Be,[b(t.$slots,"source",{},void 0,!0)],512)):m("",!0),O.value?m("",!0):(s(),z(we,{key:7,config:{type:"tiremarks",style:{backgroundColor:e.value.style.chart.backgroundColor,tiremarks:{color:"#CCCCCC"}}}},null,8,["config"]))],14,Ae))}},Ue=Pe(Ge,[["__scopeId","data-v-93332410"]]);export{Ue as default};
