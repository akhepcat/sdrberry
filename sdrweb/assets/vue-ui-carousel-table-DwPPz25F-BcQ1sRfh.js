import{z as Ae,r as a,D as ke,b as B,B as V,C as M,c as F,w as q,ac as re,K as de,V as we,N as Te,o as s,a as r,e as N,M as d,g as H,h as j,m as v,P as G,k as U,p as D,q as X,u as x,O as Ie,L as _,n as Be,i as ve,j as Fe,l as z}from"./index-UNQvOp-_.js";import{c as _e}from"./useNestedProp-BxrcwmTZ-CudEJDco.js";import{r as ze,a as Pe}from"./usePrinter-CLcxWv-4-BCaxEi1-.js";import Re from"./vue-ui-skeleton-Dgzcn3FL-BesRK3Fh.js";import{s as Oe}from"./vue-data-ui-DF7u-eZV-Cm3hFNaA.js";import"./PackageVersion-mSsg8dpu-BpMA5JNq.js";const Ne=["id"],Se=["height"],Ee=["data-cell","height"],Le={key:2,ref:"source",dir:"auto"},Ve={__name:"vue-ui-carousel-table",props:{config:{type:Object,default(){return{}}},dataset:{type:Object,default(){return{}}}},setup(m,{expose:ce}){const n=m,{vue_ui_carousel_table:pe}=Ae(),S=a(ke()),K=a(!1),$=a(!!n.dataset);B(()=>{Q()});function Q(){V(n.dataset)?M({componentName:"VueUiCarouselTable",type:"dataset"}):((!n.dataset.head||V(n.dataset.head))&&(M({componentName:"VueUiCarouselTable",type:"datasetAttribute",property:"head"}),$.value=!1),(!n.dataset.body||V(n.dataset.body))&&(M({componentName:"VueUiCarouselTable",type:"datasetAttribute",property:"body"}),$.value=!1))}const e=F({get:()=>W(),set:t=>t});function W(){return _e({userConfig:n.config,defaultConfig:pe})}q(()=>n.config,t=>{e.value=W(),Q()},{deep:!0}),q(()=>n.dataset,t=>{E()},{deep:!0});const{isPrinting:Y,isImaging:Z,generatePdf:he,generateImage:J}=ze({elementId:`carousel-table_${S.value}`,fileName:e.value.caption.text||"vue-ui-carousel-table"}),c=a({showAnimation:e.value.animation.use}),u=a(null),ee=a(null),C=a(null),A=a(null),k=a(0),P=a(0),R=a(!1),w=a(null),h=a(null),T=a(0);function E(){w.value&&(h.value={elements:w.value.getElementsByTagName("tr"),heights:Array.from(w.value.getElementsByTagName("tr")).map(t=>t.getBoundingClientRect().height)})}B(E);const ge=F(()=>!h.value||!h.value.heights.length?0:Math.max(...h.value.heights)+k.value+P.value),me=F(()=>n.dataset.body?e.value.tbody.tr.visible<=n.dataset.body.length?e.value.tbody.tr.visible:n.dataset.body.length:0),be=F(()=>(e.value.tbody.tr.height+e.value.tbody.tr.td.padding.top+e.value.tbody.tr.td.padding.bottom+e.value.tbody.tr.border.size*2)*me.value+k.value+P.value),O=a(0),I=a(null),b=a(0),y=a(!1),te=a(0);B(()=>{C.value&&(k.value=C.value.getBoundingClientRect().height),A.value&&(P.value=A.value.getBoundingClientRect().height),c.value.showAnimation&&h.value&&ae()}),B(()=>{if(u.value){let t=function(){const i=l.getBoundingClientRect().bottom;o.forEach(p=>{p.getBoundingClientRect().top<i?p.style.visibility="hidden":p.style.visibility="visible"})};const l=u.value.querySelector("thead"),o=Array.from(w.value.querySelectorAll("tr"));u.value.addEventListener("scroll",t),t(),re(()=>{u.value.removeEventListener("scroll",t)})}});function ye(t){K.value=t,te.value+=1}function ae(){!I.value&&!y.value&&(I.value=requestAnimationFrame(oe))}function fe(){if(!u.value)return!1;const{scrollTop:t,scrollHeight:l,clientHeight:o}=u.value;return t+o>=l}function oe(t){y.value||(b.value||(b.value=t),t-b.value>=e.value.animation.speedMs&&(O.value+=h.value.heights[T.value],(fe()||T.value>=h.value.heights.length)&&(O.value=0,T.value=-1),T.value+=1,u.value&&u.value.scrollTo({top:O.value,behavior:"smooth"}),b.value=t),I.value=requestAnimationFrame(oe))}function g(){y.value=!0,cancelAnimationFrame(I.value),I.value=null}re(g);function f(){!y.value||!c.value.showAnimation||(y.value=!1,b.value=0,ae())}function xe(){e.value.animation.pauseOnHover&&g()}const L=a(null);function $e(){g(),clearTimeout(L.value)}function le(){clearTimeout(L.value),L.value=setTimeout(f,1e3)}q(()=>e.value.animation.use,t=>{t?(c.value.showAnimation=!0,f()):(c.value.showAnimation=!1,g())});const Ce=F(()=>e.value.responsiveBreakpoint);B(()=>{const t=new ResizeObserver(l=>{l.forEach(o=>{R.value=o.contentRect.width<Ce.value}),k.value=C.value?C.value.getBoundingClientRect().height:0,P.value=A.value?A.value.getBoundingClientRect().height:0,T.value=0,de(()=>{g(),b.value=0,O.value=0,E(),f()})});u.value&&t.observe(u.value)});function ne(){he()}function ie(){c.value.showAnimation=!c.value.showAnimation,c.value.showAnimation?f():g()}function se(){de(()=>{const t=n.dataset.head.map((i,p)=>[[n.dataset.body[p]]]),l=[[e.value.caption.text],[n.dataset.head.map(i=>[i])]].concat(t),o=we(l);Te({csvContent:o,title:e.value.caption.text||"vue-ui-carousel-table"})})}return ce({pauseAnimation:g,resumeAnimation:f,toggleAnimation:ie,generateCsv:se,generatePdf:ne,generateImage:J}),(t,l)=>(s(),r("div",{style:{position:"relative",overflow:"visible"},ref_key:"chartContainer",ref:ee},[N("div",{ref_key:"tableContainer",ref:u,id:`carousel-table_${S.value}`,style:d({height:x(Y)||x(Z)?"auto":`${Math.max(be.value,ge.value)}px`,containerType:"inline-size",position:"relative",overflow:"auto",fontFamily:e.value.fontFamily}),class:Be({"vue-ui-responsive":R.value,"is-playing":!y.value}),onMouseover:l[0]||(l[0]=o=>xe()),onMouseleave:l[1]||(l[1]=o=>f()),onTouchstart:l[2]||(l[2]=o=>$e()),onTouchend:l[3]||(l[3]=o=>le()),onTouchcancel:l[4]||(l[4]=o=>le())},[$.value?(s(),r("table",{key:0,class:"vue-data-ui-carousel-table",style:d({...e.value.style,border:`${e.value.border.size}px solid ${e.value.border.color}`,width:"100%",borderCollapse:"collapse"})},[N("caption",{ref_key:"caption",ref:C,class:"vue-data-ui-carousel-table-caption",style:d({...e.value.caption.style,fontFamily:"inherit",position:"sticky",top:0,zIndex:2,paddingTop:e.value.caption.padding.top+"px",paddingRight:e.value.caption.padding.right+"px",paddingBottom:e.value.caption.padding.bottom+"px",paddingLeft:e.value.caption.padding.left+"px",boxShadow:R.value?e.value.thead.tr.style.boxShadow:"none",minHeight:"36px"})},[H(j(e.value.caption.text&&!t.$slots.caption?e.value.caption.text:"")+" ",1),v(t.$slots,"caption",{},void 0,!0)],4),N("thead",{style:d({...e.value.thead.style,position:"sticky",top:`${k.value}px`,zIndex:1})},[N("tr",{ref_key:"tableRow",ref:A,role:"row",style:d({...e.value.thead.tr.style,border:e.value.thead.tr.border.size?`${e.value.thead.tr.border.size}px solid ${e.value.thead.tr.border.color}`:"none",boxShadow:R.value?"none":e.value.thead.tr.style.boxShadow}),height:`${e.value.thead.tr.height}px`},[(s(!0),r(G,null,U(m.dataset.head,(o,i)=>(s(),r("th",{role:"cell",key:`th_${i}`,style:d({...e.value.thead.tr.th.style,border:e.value.thead.tr.th.border.size?`${e.value.thead.tr.th.border.size}px solid ${e.value.thead.tr.th.border.color}`:"none",paddingTop:e.value.thead.tr.th.padding.top+"px",paddingRight:e.value.thead.tr.th.padding.right+"px",paddingBottom:e.value.thead.tr.th.padding.bottom+"px",paddingLeft:e.value.thead.tr.th.padding.left+"px"})},[H(j(t.$slots.th?"":o)+" ",1),v(t.$slots,"th",D(X({th:o,colIndex:i})),void 0,!0)],4))),128))],12,Se)],4),m.dataset.body&&m.dataset.head?(s(),r("tbody",{key:0,ref_key:"tbody",ref:w,style:d({clipPath:"inset(0,0,0,0)"})},[(s(!0),r(G,null,U(m.dataset.body,(o,i)=>(s(),r("tr",{style:d({...e.value.tbody.tr.style,border:`${e.value.tbody.tr.border.size}px solid ${e.value.tbody.tr.border.color}`,verticalAlign:"middle"})},[(s(!0),r(G,null,U(o,(p,ue)=>(s(),r("td",{role:"cell","data-cell":m.dataset.head[ue]||"",style:d({...e.value.tbody.tr.td.style,border:`${e.value.tbody.tr.td.border.size}px solid ${e.value.tbody.tr.td.border.color}`,backgroundColor:x(Ie)(e.value.tbody.tr.td.style.backgroundColor,i%2===0&&e.value.tbody.tr.td.alternateColor?e.value.tbody.tr.td.alternateOpacity*100:100),paddingTop:e.value.tbody.tr.td.padding.top+"px",paddingRight:e.value.tbody.tr.td.padding.right+"px",paddingBottom:e.value.tbody.tr.td.padding.bottom+"px",paddingLeft:e.value.tbody.tr.td.padding.left+"px",verticalAlign:"middle"}),height:`${e.value.tbody.tr.height}px`},[H(j(t.$slots.td?"":p)+" ",1),v(t.$slots,"td",D(X({td:p,rowIndex:i,colIndex:ue})),void 0,!0)],12,Ee))),256))],4))),256))],4)):_("",!0)],4)):_("",!0)],46,Ne),$.value?_("",!0):(s(),ve(Re,{key:0,config:{type:"table"}})),e.value.userOptions.show&&$.value?(s(),ve(Pe,{ref:"details",key:`user_option_${te.value}`,backgroundColor:e.value.style.backgroundColor,color:e.value.style.color,isPrinting:x(Y),isImaging:x(Z),uid:S.value,hasTooltip:!1,hasPdf:e.value.userOptions.buttons.pdf,hasImg:e.value.userOptions.buttons.img,hasXls:e.value.userOptions.buttons.csv,hasTable:!1,hasLabel:!1,hasAnimation:e.value.userOptions.buttons.animation,isAnimation:!c.value.showAnimation,hasFullscreen:e.value.userOptions.buttons.fullscreen,isFullscreen:K.value,chartElement:ee.value,position:e.value.userOptions.position,titles:{...e.value.userOptions.buttonTitles},zIndex:3,offsetX:12,onGeneratePdf:ne,onGenerateCsv:se,onGenerateImage:x(J),onToggleAnimation:ie,onToggleFullscreen:ye},Fe({_:2},[t.$slots.optionPdf?{name:"optionPdf",fn:z(()=>[v(t.$slots,"optionPdf",{},void 0,!0)]),key:"0"}:void 0,t.$slots.optionCsv?{name:"optionCsv",fn:z(()=>[v(t.$slots,"optionCsv",{},void 0,!0)]),key:"1"}:void 0,t.$slots.optionImg?{name:"optionImg",fn:z(()=>[v(t.$slots,"optionImg",{},void 0,!0)]),key:"2"}:void 0,t.$slots.optionAnimation?{name:"optionAnimation",fn:z(()=>[v(t.$slots,"optionAnimation",{},void 0,!0)]),key:"3"}:void 0,t.$slots.optionFullscreen?{name:"optionFullscreen",fn:z(({toggleFullscreen:o,isFullscreen:i})=>[v(t.$slots,"optionFullscreen",D(X({toggleFullscreen:o,isFullscreen:i})),void 0,!0)]),key:"4"}:void 0]),1032,["backgroundColor","color","isPrinting","isImaging","uid","hasPdf","hasImg","hasXls","hasAnimation","isAnimation","hasFullscreen","isFullscreen","chartElement","position","titles","onGenerateImage"])):_("",!0),t.$slots.source?(s(),r("div",Le,[v(t.$slots,"source",{},void 0,!0)],512)):_("",!0)],512))}},De=Oe(Ve,[["__scopeId","data-v-1b9d6aaa"]]);export{De as default};
