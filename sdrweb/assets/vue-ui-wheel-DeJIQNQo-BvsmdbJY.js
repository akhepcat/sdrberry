import{z as le,c as f,r as n,D as oe,H as se,w as Y,B as ne,C as re,b as ue,ac as ie,a1 as U,o as r,a as v,i as w,L as h,j as ce,l as b,m as y,p as I,q as _,u,M as V,n as q,J as ve,f as he,P as de,k as ye,h as ge,U as fe,a0 as D,G as me}from"./index-DWKgdAH2.js";import{x as pe}from"./Title-DyD-mBPN-Cd9Bnlgg.js";import{r as ke,a as we}from"./usePrinter-CLcxWv-4-dA-zEbQs.js";import{O as be,k as xe}from"./useResponsive-CoxXLe23-CoJWR8uA.js";import Ce from"./vue-ui-skeleton-Dgzcn3FL-QTPCyjXQ.js";import{c as E}from"./useNestedProp-BxrcwmTZ-DuVaLmrv.js";import{p as $e}from"./PackageVersion-mSsg8dpu-BMuAJ9y0.js";import{S as Pe}from"./PenAndPaper-Dk41ZrJ0-DIRvLwPQ.js";import{s as Ie}from"./vue-data-ui-DF7u-eZV-BLQGmUKN.js";const _e=["id"],Fe=["xmlns","viewBox"],Oe=["x1","x2","y1","y2","stroke","stroke-width","stroke-linecap"],ze=["cx","cy","r","stroke","stroke-width"],Ae=["x","y","font-size","fill","font-weight"],Me={key:5,class:"vue-data-ui-watermark"},Se={__name:"vue-ui-wheel",props:{config:{type:Object,default(){return{}}},dataset:{type:Object,default(){return{}}}},setup(J,{expose:L}){const d=J,{vue_ui_wheel:R}=le(),x=f(()=>!!d.dataset&&Object.keys(d.dataset).length),C=n(oe()),W=n(null),F=n(0),g=n(null),O=n(null),z=n(null),A=n(null),M=n(0),e=f({get:()=>S(),set:t=>t});function S(){const t=E({userConfig:d.config,defaultConfig:R});return t.theme?{...E({userConfig:se.vue_ui_wheel[t.theme]||d.config,defaultConfig:t})}:t}Y(()=>d.config,t=>{e.value=S(),j(),M.value+=1},{deep:!0});const{isPrinting:B,isImaging:N,generatePdf:T,generateImage:G}=ke({elementId:C.value,fileName:e.value.style.chart.title.text||"vue-ui-wheel"}),K=f(()=>e.value.userOptions.show&&!e.value.style.chart.title.text),l=n({size:360,height:360,width:360}),$=n(e.value.style.chart.layout.percentage.fontSize),i=f(()=>({radius:Math.min(l.value.width,l.value.height)*.9/2,centerX:l.value.width/2,centerY:l.value.height/2}));function X(t,o=1){return{x:i.value.centerX+i.value.radius*Math.cos(29.85+t*Math.PI/180)*o,y:i.value.centerY+i.value.radius*Math.sin(29.85+t*Math.PI/180)*o}}const s=n(e.value.style.chart.animation.use?0:d.dataset.percentage||0);Y(()=>d.dataset,t=>{e.value.style.chart.animation.use?H(t.percentage):s.value=t.percentage||0},{deep:!0});const m=n(null);ue(()=>{j()});function j(){if(ne(d.dataset)&&re({componentName:"VueUiWheel",type:"dataset"}),H(d.dataset.percentage||0),e.value.responsive){const t=be(()=>{const{width:o,height:a}=xe({chart:g.value,title:e.value.style.chart.title.text?O.value:null,source:z.value,noTitle:A.value});l.value.width=o,l.value.height=a,$.value=e.value.style.chart.layout.percentage.fontSize/360*Math.min(o,a)});m.value=new ResizeObserver(t),m.value.observe(g.value.parentNode)}}ie(()=>{m.value&&m.value.disconnect()});function H(t){let o=e.value.style.chart.animation.speed;const a=Math.abs(t-s.value)/(o*120);function c(){s.value<t?s.value=Math.min(s.value+a,t):s.value>t&&(s.value=Math.max(s.value-a,t)),s.value!==t&&requestAnimationFrame(c)}c()}const Q=f(()=>{const t=[];for(let o=0;o<100;o+=1){const a=s.value>o?e.value.style.chart.layout.wheel.ticks.activeColor:e.value.style.chart.layout.wheel.ticks.inactiveColor,{x:c,y:ee}=X(l.value.size/100*o),{x:te,y:ae}=X(l.value.size/100*o,e.value.style.chart.layout.wheel.ticks.sizeRatio);t.push({x1:c,y1:ee,x2:te,y2:ae,color:e.value.style.chart.layout.wheel.ticks.gradient.show?U(a,o/100*(e.value.style.chart.layout.wheel.ticks.gradient.shiftHueIntensity/100)):a})}return t}),p=n(!1);function Z(t){p.value=t,F.value+=1}const k=n(!1);function P(){k.value=!k.value}return L({generatePdf:T,generateImage:G,toggleAnnotator:P}),(t,o)=>(r(),v("div",{class:"vue-ui-wheel",ref_key:"wheelChart",ref:g,id:C.value,style:V(`font-family:${e.value.style.fontFamily};width:100%; text-align:center;background:${e.value.style.chart.backgroundColor};${e.value.responsive?"height:100%":""}`)},[e.value.userOptions.buttons.annotator?(r(),w(Pe,{key:0,parent:g.value,backgroundColor:e.value.style.chart.backgroundColor,color:e.value.style.chart.color,active:k.value,onClose:P},null,8,["parent","backgroundColor","color","active"])):h("",!0),K.value?(r(),v("div",{key:1,ref_key:"noTitle",ref:A,class:"vue-data-ui-no-title-space",style:"height:36px; width: 100%;background:transparent"},null,512)):h("",!0),e.value.style.chart.title.text?(r(),v("div",{key:2,ref_key:"chartTitle",ref:O,style:"width:100%;background:transparent;padding-bottom:12px"},[(r(),w(pe,{key:`title_${M.value}`,config:{title:{cy:"wheel-title",...e.value.style.chart.title},subtitle:{cy:"wheel-subtitle",...e.value.style.chart.title.subtitle}}},null,8,["config"]))],512)):h("",!0),e.value.userOptions.show&&x.value?(r(),w(we,{ref_key:"details",ref:W,key:`user_options_${F.value}`,backgroundColor:e.value.style.chart.backgroundColor,color:e.value.style.chart.color,isPrinting:u(B),isImaging:u(N),uid:C.value,hasPdf:e.value.userOptions.buttons.pdf,hasImg:e.value.userOptions.buttons.img,hasFullscreen:e.value.userOptions.buttons.fullscreen,hasXls:!1,isFullscreen:p.value,position:e.value.userOptions.position,titles:{...e.value.userOptions.buttonTitles},hasAnnotator:e.value.userOptions.buttons.annotator,isAnnotation:k.value,chartElement:g.value,onToggleFullscreen:Z,onGeneratePdf:u(T),onGenerateImage:u(G),onToggleAnnotator:P},ce({_:2},[t.$slots.optionPdf?{name:"optionPdf",fn:b(()=>[y(t.$slots,"optionPdf",{},void 0,!0)]),key:"0"}:void 0,t.$slots.optionImg?{name:"optionImg",fn:b(()=>[y(t.$slots,"optionImg",{},void 0,!0)]),key:"1"}:void 0,t.$slots.optionFullscreen?{name:"optionFullscreen",fn:b(({toggleFullscreen:a,isFullscreen:c})=>[y(t.$slots,"optionFullscreen",I(_({toggleFullscreen:a,isFullscreen:c})),void 0,!0)]),key:"2"}:void 0,t.$slots.optionAnnotator?{name:"optionAnnotator",fn:b(({toggleAnnotator:a,isAnnotator:c})=>[y(t.$slots,"optionAnnotator",I(_({toggleAnnotator:a,isAnnotator:c})),void 0,!0)]),key:"3"}:void 0]),1032,["backgroundColor","color","isPrinting","isImaging","uid","hasPdf","hasImg","hasFullscreen","isFullscreen","position","titles","hasAnnotator","isAnnotation","chartElement","onGeneratePdf","onGenerateImage"])):h("",!0),x.value?(r(),v("svg",{key:4,xmlns:u(ve),class:q({"vue-data-ui-fullscreen--on":p.value,"vue-data-ui-fulscreen--off":!p.value}),viewBox:`0 0 ${l.value.width<=0?10:l.value.width} ${l.value.height<=0?10:l.value.height}`,style:V(`max-width:100%;overflow:visible;background:transparent;color:${e.value.style.chart.color}`)},[he($e),(r(!0),v(de,null,ye(Q.value,(a,c)=>(r(),v("line",{x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2,stroke:a.color,"stroke-width":5/360*Math.min(l.value.width,l.value.height),"stroke-linecap":e.value.style.chart.layout.wheel.ticks.rounded?"round":"butt",class:q({"vue-ui-tick-animated":e.value.style.chart.animation.use&&c<=s.value})},null,10,Oe))),256)),e.value.style.chart.layout.innerCircle.show?(r(),v("circle",{key:0,cx:i.value.centerX,cy:i.value.centerY,r:i.value.radius*.8<=0?1e-4:i.value.radius*.8,stroke:e.value.style.chart.layout.innerCircle.stroke,"stroke-width":e.value.style.chart.layout.innerCircle.strokeWidth,fill:"none"},null,8,ze)):h("",!0),e.value.style.chart.layout.percentage.show?(r(),v("text",{key:1,x:i.value.centerX,y:i.value.centerY+$.value/3,"font-size":$.value,fill:e.value.style.chart.layout.wheel.ticks.gradient.show?u(U)(e.value.style.chart.layout.wheel.ticks.activeColor,s.value/100*(e.value.style.chart.layout.wheel.ticks.gradient.shiftHueIntensity/100)):e.value.style.chart.layout.wheel.ticks.activeColor,"text-anchor":"middle","font-weight":e.value.style.chart.layout.percentage.bold?"bold":"normal",style:{"font-variant-numeric":"tabluar-nums"}},ge(u(fe)(e.value.style.chart.layout.percentage.formatter,u(D)(s.value),u(me)({v:u(D)(s.value),s:"%",r:e.value.style.chart.layout.percentage.rounding}))),9,Ae)):h("",!0),y(t.$slots,"svg",{svg:l.value},void 0,!0)],14,Fe)):h("",!0),t.$slots.watermark?(r(),v("div",Me,[y(t.$slots,"watermark",I(_({isPrinting:u(B)||u(N)})),void 0,!0)])):h("",!0),t.$slots.source?(r(),v("div",{key:6,ref_key:"source",ref:z,dir:"auto"},[y(t.$slots,"source",{},void 0,!0)],512)):h("",!0),x.value?h("",!0):(r(),w(Ce,{key:7,config:{type:"wheel",style:{backgroundColor:e.value.style.chart.backgroundColor,wheel:{color:"#CCCCCC"}}}},null,8,["config"]))],12,_e))}},Ve=Ie(Se,[["__scopeId","data-v-bc4a7284"]]);export{Ve as default};
